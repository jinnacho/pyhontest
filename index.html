<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파이썬 프로그래밍 통합 실습 센터</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Fira+Code:wght@400;500&display=swap');
        
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8fafc; }
        .code-font { font-family: 'Fira Code', monospace; }
        .active-tab { border-bottom: 4px solid #3b82f6; color: #3b82f6; }
        .topic-card:hover { transform: translateY(-2px); transition: all 0.2s; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #3498db;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
            vertical-align: middle;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        #code-editor:focus {
            outline: none;
            background-color: #252525;
        }
    </style>
</head>
<body class="text-slate-800">

    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <i class="fa-brands fa-python text-3xl text-blue-500"></i>
                    <span class="font-bold text-xl tracking-tight text-slate-900">Python Mastery Lab</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <button onclick="switchTab('curriculum')" id="btn-curriculum" class="tab-btn py-5 px-1 font-medium active-tab">커리큘럼</button>
                    <button onclick="switchTab('practice')" id="btn-practice" class="tab-btn py-5 px-1 font-medium text-slate-500 hover:text-blue-500">코딩 실습</button>
                    <button onclick="switchTab('assignment')" id="btn-assignment" class="tab-btn py-5 px-1 font-medium text-slate-500 hover:text-blue-500">과제 제출</button>
                </div>
                <div class="flex items-center gap-3">
                    <button onclick="copyShareLink()" class="flex items-center gap-2 bg-slate-100 hover:bg-slate-200 text-slate-700 px-4 py-2 rounded-xl text-sm font-bold transition">
                        <i class="fa-solid fa-share-nodes"></i>
                        <span>공유하기</span>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- SECTION 1: Curriculum -->
        <section id="tab-curriculum" class="tab-content space-y-8">
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-xl">
                <div class="flex">
                    <div class="flex-shrink-0"><i class="fa-solid fa-circle-info text-blue-400"></i></div>
                    <div class="ml-3">
                        <p class="text-sm text-blue-700 font-bold">미션 안내:</p>
                        <p class="text-sm text-blue-600">아래 카드 또는 왼쪽 메뉴에서 실습을 선택하세요. 기초부터 심화까지 총 13개의 미션이 준비되어 있습니다.</p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- 주요 미션 미리보기 -->
                <div onclick="loadExercise('vars')" class="cursor-pointer bg-white p-6 rounded-2xl shadow-sm border border-slate-100 topic-card">
                    <div class="w-10 h-10 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mb-4">
                        <i class="fa-solid fa-calculator"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">기초: 형 변환</h3>
                    <p class="text-sm text-slate-500">데이터 타입의 이해와 변환법을 배웁니다.</p>
                </div>
                <div onclick="loadExercise('if_logic')" class="cursor-pointer bg-white p-6 rounded-2xl shadow-sm border border-slate-100 topic-card">
                    <div class="w-10 h-10 bg-yellow-100 text-yellow-600 rounded-lg flex items-center justify-center mb-4">
                        <i class="fa-solid fa-code-branch"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">기초: 조건문</h3>
                    <p class="text-sm text-slate-500">성적 판별기를 통해 if문을 익힙니다.</p>
                </div>
                <div onclick="loadExercise('loop_sum')" class="cursor-pointer bg-white p-6 rounded-2xl shadow-sm border border-slate-100 topic-card">
                    <div class="w-10 h-10 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mb-4">
                        <i class="fa-solid fa-sigma"></i>
                    </div>
                    <h3 class="font-bold text-lg mb-2">중급: 반복문 합계</h3>
                    <p class="text-sm text-slate-500">1부터 N까지의 합을 구하는 로직을 작성합니다.</p>
                </div>
            </div>
        </section>

        <!-- SECTION 2: Practice -->
        <section id="tab-practice" class="tab-content hidden space-y-6">
            <div class="flex flex-col lg:flex-row gap-6">
                <div class="w-full lg:w-1/4 space-y-4">
                    <div class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 max-h-[700px] overflow-y-auto">
                        <h4 class="font-bold text-slate-400 text-xs mb-4 uppercase sticky top-0 bg-white py-2">실습 미션 리스트 (13)</h4>
                        <div class="space-y-1">
                            <button id="btn-ex-vars" onclick="loadExercise('vars')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">1. 형 변환 오류</button>
                            <button id="btn-ex-matrix" onclick="loadExercise('matrix')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">2. 리스트 인덱싱</button>
                            <button id="btn-ex-loop" onclick="loadExercise('loop')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">3. 구구단 빈칸</button>
                            <div class="h-px bg-slate-100 my-2"></div>
                            <button id="btn-ex-if_logic" onclick="loadExercise('if_logic')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">4. 성적 등급 계산</button>
                            <button id="btn-ex-loop_sum" onclick="loadExercise('loop_sum')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">5. 누적 합계 구하기</button>
                            <button id="btn-ex-list_append" onclick="loadExercise('list_append')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">6. 리스트 요소 추가</button>
                            <button id="btn-ex-string_slice" onclick="loadExercise('string_slice')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">7. 문자열 슬라이싱</button>
                            <button id="btn-ex-dict_basic" onclick="loadExercise('dict_basic')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">8. 딕셔너리 정보 찾기</button>
                            <button id="btn-ex-func_sum" onclick="loadExercise('func_sum')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">9. 함수 정의하기</button>
                            <button id="btn-ex-even_filter" onclick="loadExercise('even_filter')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">10. 짝수 판별 루프</button>
                            <button id="btn-ex-list_len" onclick="loadExercise('list_len')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">11. 리스트 길이와 평균</button>
                            <button id="btn-ex-search_val" onclick="loadExercise('search_val')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">12. 리스트 검색</button>
                            <button id="btn-ex-star_pyramid" onclick="loadExercise('star_pyramid')" class="w-full text-left px-3 py-2 rounded-lg text-sm hover:bg-slate-50">13. 별 찍기 (피라미드)</button>
                        </div>
                    </div>
                </div>

                <div class="w-full lg:w-3/4 space-y-4">
                    <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                        <div class="bg-slate-900 px-6 py-4 flex justify-between items-center">
                            <div class="flex items-center gap-3">
                                <span id="current-filename" class="text-sm text-slate-400 code-font">practice.py</span>
                            </div>
                            <button onclick="runCodeSim()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-1.5 rounded-full text-sm font-bold flex items-center gap-2 transition">
                                <i class="fa-solid fa-play text-[10px]"></i>
                                <span>RUN CODE</span>
                            </button>
                        </div>
                        <div class="flex flex-col md:flex-row h-[500px]">
                            <div class="w-full md:w-1/2 p-0 overflow-auto bg-[#1e1e1e]">
                                <pre class="p-6 text-slate-300 code-font text-sm leading-relaxed min-h-full" id="code-editor" contenteditable="true" spellcheck="false"></pre>
                            </div>
                            <div class="w-full md:w-1/2 bg-black p-6 flex flex-col border-l border-slate-800">
                                <div id="output-screen" class="flex-grow code-font text-xs overflow-auto whitespace-pre-wrap leading-relaxed text-green-400">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: Assignment -->
        <section id="tab-assignment" class="tab-content hidden">
            <div class="max-w-4xl mx-auto bg-white p-10 rounded-3xl shadow-sm border border-slate-100">
                <h2 class="text-2xl font-bold mb-6 text-slate-900">최종 코드 제출</h2>
                <form id="submission-form" class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="student-id" placeholder="학번" class="bg-slate-50 rounded-xl p-4 outline-none focus:ring-2 focus:ring-blue-500">
                        <input type="text" id="student-name" placeholder="이름" class="bg-slate-50 rounded-xl p-4 outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <textarea id="submission-code" rows="10" class="w-full bg-slate-900 text-blue-300 rounded-xl p-4 code-font text-sm" placeholder="# 이곳에 제출할 최종 완성 코드를 입력하세요."></textarea>
                    
                    <button type="button" id="submit-btn" onclick="submitAssignment()" class="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold hover:bg-slate-800 transition flex justify-center items-center">
                        <span id="btn-text">구글 시트에 제출하기</span>
                    </button>
                </form>
            </div>
        </section>

    </main>

    <input type="text" id="share-link-input" class="fixed -top-full left-0 opacity-0" readonly>

    <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-8 py-4 rounded-2xl shadow-2xl transform translate-y-32 transition-all duration-500 flex items-center gap-4 z-[100]">
        <div id="toast-icon-bg" class="w-8 h-8 rounded-full flex items-center justify-center bg-blue-500">
            <i id="toast-icon" class="fa-solid fa-info"></i>
        </div>
        <div>
            <div id="toast-title" class="font-bold text-sm">알림</div>
            <div id="toast-message" class="text-xs text-slate-400">메시지 내용</div>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyMLRVmoQdEAnXmZK9eAz5THUs_WgZr8dHzrBMpTTrZUpfhqR4eFITVWZc3TQ6-teFY/exec';
        let currentExerciseKey = '';

        const exercises = {
            vars: { 
                name: 'casting_error.py', 
                code: '# 1. 입력받은 숫자에 10을 더해 출력하세요.\nnum = input("숫자를 입력하세요: ")\n\n# 아래 줄을 수정하세요\nresult = num + 10\n\nprint("결과:", result)' 
            },
            matrix: { 
                name: 'matrix_indexing.py', 
                code: '# 2. 리스트에서 "서울"을 출력하세요.\ndata = [["서울", 10], ["부산", 20]]\n\n# ____를 숫자로 채우세요.\nprint("수도:", data[____][____])' 
            },
            loop: { 
                name: 'gugudan.py', 
                code: '# 3. 구구단 2단을 완성하세요.\nfor i in range(1, 10)____\n    print(f"2 x {i} = {____}")' 
            },
            if_logic: {
                name: 'grading.py',
                code: '# 4. 점수가 90점 이상이면 "A"를 출력하세요.\nscore = 95\nif score ____ 90:\n    print("A")\nelse:\n    print("B")'
            },
            loop_sum: {
                name: 'sum_to_n.py',
                code: '# 5. 1부터 10까지의 합계를 구하세요.\ntotal = 0\nfor i in range(1, ____):\n    total = total + i\nprint(total)'
            },
            list_append: {
                name: 'list_op.py',
                code: '# 6. colors 리스트에 "blue"를 추가하세요.\ncolors = ["red", "green"]\n# ____를 메서드로 채우세요.\ncolors.____("blue")\nprint(colors)'
            },
            string_slice: {
                name: 'slicing.py',
                code: '# 7. "Hello World"에서 "Hello"만 추출하세요.\ntext = "Hello World"\n# ____를 슬라이싱 범위로 채우세요.\nprint(text[____])'
            },
            dict_basic: {
                name: 'dictionary.py',
                code: '# 8. 딕셔너리에서 나이(age)를 출력하세요.\nuser = {"name": "Alice", "age": 25}\nprint(user[____])'
            },
            func_sum: {
                name: 'function.py',
                code: '# 9. 두 수를 더해 반환하는 함수를 완성하세요.\ndef add(a, b):\n    ____ a + b\n\nprint(add(10, 20))'
            },
            even_filter: {
                name: 'even_check.py',
                code: '# 10. i가 짝수일 때만 출력하도록 만드세요.\nfor i in range(1, 6):\n    if i % 2 ____ 0:\n        print(i)'
            },
            list_len: {
                name: 'average.py',
                code: '# 11. 리스트의 길이를 구해 평균을 계산하세요.\nnums = [10, 20, 30]\navg = sum(nums) / ____(nums)\nprint(avg)'
            },
            search_val: {
                name: 'searching.py',
                code: '# 12. "apple"이 리스트에 있는지 확인하세요.\nfruits = ["banana", "apple", "cherry"]\nif "apple" ____ fruits:\n    print("Found!")'
            },
            star_pyramid: {
                name: 'stars.py',
                code: '# 13. 별을 1개부터 3개까지 늘려가며 출력하세요.\nfor i in range(1, 4):\n    print("*" ____ i)'
            }
        };

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active-tab', 'text-blue-600'));
            document.getElementById('btn-' + tabId).classList.add('active-tab');
        }

        function loadExercise(key) {
            currentExerciseKey = key;
            const ex = exercises[key];
            document.getElementById('current-filename').innerText = ex.name;
            document.getElementById('code-editor').innerText = ex.code;
            
            document.querySelectorAll('[id^="btn-ex-"]').forEach(btn => btn.classList.remove('bg-blue-50', 'text-blue-600', 'font-bold'));
            const activeBtn = document.getElementById('btn-ex-' + key);
            if(activeBtn) activeBtn.classList.add('bg-blue-50', 'text-blue-600', 'font-bold');
            
            switchTab('practice');
            document.getElementById('output-screen').innerHTML = `> ${ex.name} 준비됨.`;
        }

        function runCodeSim() {
            const output = document.getElementById('output-screen');
            const code = document.getElementById('code-editor').innerText;
            output.innerHTML = "$ python3 " + exercises[currentExerciseKey].name + "\n";
            
            setTimeout(() => {
                let success = false;
                let msg = "";

                // 간단한 분석 로직
                switch(currentExerciseKey) {
                    case 'vars': success = code.includes('int('); msg = success ? "결과: 15\n[성공] 문자열을 정수로 변환했습니다." : "TypeError: can only concatenate str to str"; break;
                    case 'matrix': success = code.includes('0][0'); msg = success ? "수도: 서울\n[성공] 인덱스 접근 완료." : "인덱스가 틀렸거나 빈칸입니다."; break;
                    case 'loop': success = code.includes(':') && (code.includes('2*i') || code.includes('2 * i')); msg = success ? "2 x 1 = 2\n...\n2 x 9 = 18\n[성공]" : "문법 오류 또는 계산식 확인 필요"; break;
                    case 'if_logic': success = code.includes('>='); msg = success ? "A\n[성공]" : "비교 연산자를 확인하세요."; break;
                    case 'loop_sum': success = code.includes('11'); msg = success ? "55\n[성공]" : "범위(range)를 확인하세요 (10까지 포함)."; break;
                    case 'list_append': success = code.includes('append'); msg = success ? "['red', 'green', 'blue']\n[성공]" : "리스트 추가 메서드를 사용하세요."; break;
                    case 'string_slice': success = code.includes('0:5') || code.includes(':5'); msg = success ? "Hello\n[성공]" : "슬라이싱 범위를 확인하세요."; break;
                    case 'dict_basic': success = code.includes('"age"') || code.includes("'age'"); msg = success ? "25\n[성공]" : "키 값을 확인하세요."; break;
                    case 'func_sum': success = code.includes('return'); msg = success ? "30\n[성공]" : "결과를 '반환'해야 합니다."; break;
                    case 'even_filter': success = code.includes('=='); msg = success ? "2\n4\n[성공]" : "비교 연산자(==)를 사용하세요."; break;
                    case 'list_len': success = code.includes('len'); msg = success ? "20.0\n[성공]" : "len() 함수를 사용하세요."; break;
                    case 'search_val': success = code.includes(' in '); msg = success ? "Found!\n[성공]" : "멤버 연산자(in)를 사용하세요."; break;
                    case 'star_pyramid': success = code.includes('*'); msg = success ? "*\n**\n***\n[성공]" : "문자열 반복 연산자를 확인하세요."; break;
                }

                output.innerHTML += success ? `<span class='text-green-400'>${msg}</span>` : `<span class='text-red-400'>${msg}</span>`;
            }, 500);
        }

        async function submitAssignment() {
            const studentId = document.getElementById('student-id').value;
            const name = document.getElementById('student-name').value;
            const code = document.getElementById('submission-code').value;
            if (!studentId || !name || !code) { showToast("모두 입력해주세요.", "error"); return; }
            
            const btn = document.getElementById('submit-btn');
            btn.disabled = true;
            document.getElementById('btn-text').innerText = "전송 중...";

            try {
                await fetch(scriptURL, {
                    method: 'POST', mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ studentId, name, code })
                });
                showToast("제출 완료!", "success");
                document.getElementById('submission-form').reset();
            } catch (e) {
                showToast("오류 발생", "error");
            } finally {
                btn.disabled = false;
                document.getElementById('btn-text').innerText = "구글 시트에 제출하기";
            }
        }

        function copyShareLink() {
            const shareInput = document.getElementById('share-link-input');
            shareInput.value = window.location.href;
            shareInput.select();
            document.execCommand('copy');
            showToast("링크가 복사되었습니다!", "success");
        }

        function showToast(message, type) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').innerText = message;
            toast.classList.remove('translate-y-32');
            setTimeout(() => { toast.classList.add('translate-y-32'); }, 3000);
        }

        window.onload = () => { loadExercise('vars'); };
    </script>
</body>
</html>
